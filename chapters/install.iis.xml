<?xml version="1.0" encoding="iso-8859-1"?>
<!-- EN-Revision: 1.5 Maintainer: darvina Status: ready -->
  <sect1 id="install.iis">
   <title>Server IIS/PWS</title>
   <para>
    Questa sezione contiene note e suggerimenti specifici per IIS (Microsoft
    Internet Information Server). Installare il PHP su 
    <link linkend="install.iis.iis3">PWS/IIS 3</link>,
    <link linkend="install.iis.pws4">PWS 4 o recenti</link> e
    <link linkend="install.iis.iis4">IIS 4 o recenti</link>.
   </para>

   <note>
    <title>Importante per utenti CGI</title>
    <para>
     Leggere la <link linkend="faq.installation.forceredirect">faq
     su cgi.force_redirect</link> per dettagli importanti. Questa direttiva deve
     essere impostata a <literal>0</literal>.
    </para>
   </note>

   <sect2 id="install.iis.iis3">
    <title>Windows e PWS/IIS 3</title>
    
    <simpara>
     Il metodo raccomandato per l'installazione con questi server è di utilizzare
     il file REG incluso con la distribuzione
     (pws-php4cgi.reg). Può essere necessario modificare questo file 
     per adeguarlo alle estensioni usate e alle directory in
     cui è installato il PHP-. Oppure si può seguire i seguenti passi
     per farlo manualmente.
    </simpara>
    <warning>
     <para>
      Queste istruzioni richiedono di lavorare direttamente sul registry
      di Windows. Un errore potrebbe lasciare il sistema in uno stato instabile.
      Si raccomanda di fare una copia di backup del registry prima di cominciare.
      Il gruppo di sviluppo di PHP non è responsabile se si danneggia
      il registry.
     </para>
    </warning>

    <para>
     <itemizedlist>
      <listitem>
       <simpara>
        Eseguire Regedit.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Posizionarsi in: <literal>HKEY_LOCAL_MACHINE /System
         /CurrentControlSet /Services /W3Svc /Parameters
         /ScriptMap</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Nel menu modifica selezionare: <literal>Nuovo->Stringa</literal> (<literal>New->String Value</literal>).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Digitare l'estensione che si desidera utilizzare per gli script 
        PHP, Ad esempio <literal>.php</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Fare un doppio click su 'nuovo valore stringa' e inserire il percorso a
        <literal>php.exe</literal> nel campo valore. es.:
        <literal>c:\php\php.exe</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Ripetere questi passi per ciascuna estensione si desideri associare
        agli script PHP.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     I seguenti passi non influiscono sull'installazione del server web
     e si applicano solo se si desidera che gli script php vengano eseguiti
     quando sono lanciati da linea di comando (es. run
     <filename>c:\myscripts\test.php</filename>) o da un doppio click 
     sugli stessi da esplora risorse. Si può anche saltare questi passi 
     e optare per caricare i file PHP in un editor quando si fa un
     doppio click su di essi.
    </para>
    <para>
     <itemizedlist>
      <listitem>
       <simpara>
        Posizionarsi in: <literal>HKEY_CLASSES_ROOT</literal>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Nel menu modifica selezionare: <literal>nuovo->chiave</literal> (<literal>New->Key</literal>).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Dare come nome della chiave l'estensione che si desidera configurare
        es: <literal>.php</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Evidenziare la nuova chiave e nel pannello di destra, fare un doppio click
        su "default value" e inserire <literal>phpfile</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Ripetere il passo precedente per ogni estensione che si desidera
        inserire.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Ora crea un'altra chiave <literal>Nuovo->Chiave</literal> (<literal>New->Key</literal>) sotto
        <literal>HKEY_CLASSES_ROOT</literal> e chiamarla
        <literal>phpfile</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Evidenziare la nuova chiave <literal>phpfile</literal> e nel pannello
        di destra fare un doppio click su "default value" ed inserire
        <literal>PHP Script</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Click destro sulla chiave <literal>phpfile</literal> e selezionare
        <literal>Nuovo->Chiave</literal>(<literal>New->Key</literal>), chiamarla <literal>Shell</literal>.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Click destro sulla chiave <literal>Shell</literal> e selezionare
        <literal>Nuovo->Chiave</literal>(<literal>New->Key</literal>), chiamarla <literal>open</literal>.        
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Click destro sulla chiave <literal>open</literal> e selezionare
        <literal>Nuovo->Chiave</literal>(<literal>New->Key</literal>), chiamarla <literal>command</literal>.        
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Evidenziare la nuova chiave <literal>command</literal> e nel pannello di destra
        fare un doppio click su "default value" ed inserire il percorso
        a <literal>php.exe</literal>. es:
        <literal>c:\php\php.exe -q %1</literal>. (non dimenticarsi del
        <literal>%1</literal>). 
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Uscire da Regedit.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Se si usa PWS con Windows, riavviare il PC.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <simpara>
     A questo punto gli utenti di PWS ed IIS 3 hanno il sistema operante.
     Gli utenti di IIS3 possono utilizzare un <ulink url="&url.iiscfg;">tool</ulink>
     di Steven Genusa per configurare la mappatura degli script.
    </simpara>
    
   </sect2>

   <sect2 id="install.iis.pws4">
    <title>Windows con PWS 4 e successivi</title>

    <simpara>
     Quando si installa il PHP su sistemi Windows con PWS 4 o versioni successive,
     si ha due opzioni. Una consiste nell'impostare il PHP come CGI, l'altra
     consiste nell'usare il modulo ISAPI.
    </simpara>
     
    <para>
     Se si sceglie la soluzione CGI, eseguire i seguenti passi:
     <itemizedlist>
      <listitem>
       <simpara>
        Modificare il file <filename>pws-php4cgi.reg</filename>
        (vedere nella directory SAPI) per inserire il percorso di
        <filename>php.exe</filename>.  I backslash devono essere preceduti dal carattere di escape '\'
        ad esempio:
        <literal>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\w3svc\parameters\Script Map] ".php"="c:\\php\\php.exe"</literal>
        Ora inserire questo file di registro nel sistema; dovrebbe bastare
        un doppio click sul file.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Nel PWS Manager, click destro nella direttory a cui si vuole aggiungere
        il supporto PHP e selezionare Proprietà (Properties). Spuntare
        il checkbox 'Execute' e confermare.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>

    <para>
     Se si opta per il modulo ISAPI, questi sono i passi:
     <itemizedlist>
      <listitem>
       <simpara>
        Modificare il file <filename>pws-php4cgi.reg</filename>
        (vedere nella directory SAPI) per inserire il percorso di
        <filename>php4isapi.dll</filename>.  I backslash devono essere preceduti dal carattere di escape '\'
        ad esempio:
        <literal>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\w3svc\parameters\Script Map] ".php"="c:\\php\\sapi\\php4isapi.dll"</literal>
        Ora inserire questo file di registro nel sistema; dovrebbe bastare
        un doppio click sul file.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Nel PWS Manager, click destro nella direttory a cui si vuole aggiungere
        il supporto PHP e selezionare Proprietà (Properties). Spuntare
        il checkbox 'Execute' e confermare.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>

   </sect2>

   <sect2 id="install.iis.iis4">
    <title>Windows NT/2000/XP con IIS 4 o successivi</title>

    <simpara>
     Seguire queste istruzioni per installare il PHP su sistemi NT/2000/XP
     con IIS 4 o successivi. Si hanno a disposizione due opzioni. Una consiste nell'impostare il PHP come CGI, l'altra
     consiste nell'usare il modulo ISAPI.
    </simpara>
    
    <simpara>
     In emtranbi i casi occorre avviare la Microsoft Management
     Console (può essere presente come 'Internet Services Manager', sia
     nel Windows NT 4.0 Option Pack o nel Pannello di controllo (Control
     Panel)=&gt;Administrative Tools sotto Windows 2000/XP). Quindi
     click destro sul nodo Web server (questo molto probabilmente comparirà
     come 'Default Web Server'), e selezionare 'Proprietà' ('Properties').
    </simpara>

    <para>
     Se si desidera installare il PHP come CGI seguire i seguenti passi:
     <itemizedlist>
      <listitem>
       <simpara>
        Sotto 'Home Directory', 'Virtual Directory', o
        'Directory', cliccare sul bottone 'Configuration',
        ed entrare in App Mappings.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Premere Add, e nel box Executable digitare.
        <literal>c:\php\php.exe</literal> (assumendo 
        che il PHP si trovi in c:\php\).
        </simpara>
      </listitem>
      <listitem>
       <simpara>
        Nel box Extension, digitare l'estensione dei file che si vuole
        associare come script PHP. Lasciare bianco 'Method exclusions'
        e selezionare il checkbox Script engine. Si potrebbe anche 
        selezionare il box 'check that file exists', con una ridotta penalizzazione
        nella velocità, IIS (o PWS) controlleranno che lo script esista
        ed eseguiranno l'autentificazione prima di lanciare il PHP. Questo significa
        avere più errori di tipo 404 piuttosto che avere degli errori
        CGI dovuti al fatto che il PHP non ha dato in output alcun dato.
       </simpara>
       <simpara>
        Occorre eseguire il passo precedente per ogni estensione 
        che si desideri associare al PHP.
        <literal>.php</literal> and <literal>.phtml</literal>
        sono le più comuni, anche <literal>.php3</literal> 
        può essere richiesta per compatibilità verso il passato.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Impostare le opzioni di sicurezza. (Può essere fatto dal Internet
        Service Manager), e se il server utilizza come file system NTFS,
        aggiungere i diritti di esecuzione per I_USR alla directory che contiene il
        <literal>php.exe</literal>.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    
    <para>
     Per impostare il modulo ISAPI occorre:
     <itemizedlist>
      <listitem>
       <simpara>
        Se non si desidera eseguire l'autenticazione HTTP con il PHP,
        si può (si dovrebbe) saltare questo passo. Nei filtri ISAPI,
        aggiungere un nuovo filtro. Indicare PHP come nome del filtro, e
        indicare il percorso di php4isapi.dll.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Nella 'Home Directory', cliccare sul bottone 'Configuration'.
        Aggiungere una nuova riga nel 'Application Mappings'. Indicare il percorso 
        di php4isapi.dll come Executable, dare
        <literal>.php</literal> come estensione, lasciare bianco Method
        exclusions, e selezionare il checkbox Script engine.
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Fermare completamente IIS (NET STOP iisadmin)
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Attivare IIS (NET START w3svc)
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
   </sect2>
  </sect1>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
