 <reference id="ref.mssql">
  <title>Funzioni per Microsoft SQL Server</title>
  <titleabbrev>MS SQL Server</titleabbrev>

  <refentry id="function.mssql-close">
   <refnamediv>
    <refname>mssql_close</refname>
    <refpurpose>Chiude la connessione con MS SQL Server</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_close</function></funcdef>
      <paramdef>int 
       <parameter><optional>id_connessione</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     Restituisce: vero se l'operazione riesce, falso se si verifica un errore.
    </para>
    <para> 
     La funzione <function>mssql_close</function> chiude la connessione
     ad un database MS SQL
     Server che è associata all' argomento id_connessione.
     Se l' id_connessione non viene indicato, si fa riferimento all'ultima connessione 
     aperta.     
    </para>
    <para> 
     Nota: solitamente non è necessario l'uso della funzione, dato che 
     tutte le connessioni non-persistenti sono chiuse automaticamente al
     termine dell'esecuzione dello script.
    </para>
    <para> 
     <function>mssql_close</function> non chiude i collegamenti persistenti
     aperti utilizzando <function>mssql_pconnect</function>.
    </para>
    <para> 
     Vedere anche: <function>mssql_connect</function>,
     <function>mssql_pconnect</function>.  
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-connect">
   <refnamediv>
    <refname>mssql_connect</refname>
    <refpurpose>Apre una connessione con un server MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_connect</function></funcdef>
      <paramdef>string 
       <parameter><optional>nome_server</optional></parameter>
      </paramdef>
      <paramdef>string 
       <parameter><optional>nome_utente</optional></parameter>
      </paramdef>
      <paramdef>string 
       <parameter><optional>password</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     Restituisce: un identificativo di connessione su l'operazione riesce, 
     oppure falso se si verifica un errore.
    </para>
    <para> 
     La funzione <function>mssql_connect</function> realizza una connessione
     con un server MS SQL. L' argomento nome_server deve essere un nome valido
     di server come definito nel file 'interfaces'.
    </para>
    <para> 
     Qualora la funzione <function>mssql_connect</function> venga eseguita
     una seconda volta con i medesimi parametri, non viene realizzata una nuova
     connessione, ma, invece, viene restituito l'identificativo della connessione
     già aperta.
    </para>
    <para> 
     La connessione con il server verrà chiusa non appena lo script terminerà
     l'esecuzione, a meno che la connessione non sia già stata chiusa utilizzando
     la funzione <function>mssql_close</function>.
    </para>
    <para>
     Vedere anche <function>mssql_pconnect</function>, e 
     <function>mssql_close</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-data-seek">
   <refnamediv>
    <refname>mssql_data_seek</refname>
    <refpurpose>Sposta il puntatore di riga interno</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_data_seek</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
      <paramdef>int <parameter>numero_riga</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
      Restituisce: vero se l'operazione riesce, falso se si verifica un errore.
    </para>
    <para> 
     La funzione <function>mssql_data_seek</function> sposta il puntatore
     di riga, interno al risultato associato all'identificativo di risultato,
     alla riga indicata dall'argomento numero_riga. La chiamata successiva a
     <function>mssql_fetch_row</function> restituirà la riga richiesta.
    </para>
    <para> 
     Vedere anche <function>mssql_data_seek</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-array">
   <refnamediv>
    <refname>mssql_fetch_array</refname>
    <refpurpose>Restituisce una riga in un array</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_fetch_array</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     La funzione restituisce: un array corrispondente alla riga estratta, oppure
     falso se non vi sono più righe.
    </para>
    <para>
     La funzione <function>mssql_fetch_array</function> è un' estensione 
     della funzione 
     <function>mssql_fetch_row</function>. Oltre a memorizzare i dati in un array 
     con indice numerico, la funzione memorizza i dati in un array associativo
     in cui la chiave è costituita dal nome del campo.
    </para>
    <para>
     Un aspetto da notare è che la funzione 
     <function>mssql_fetch_array</function> NON è significativamente più
     lenta rispetto a <function>mssql_fetch_row</function>, mentre nel contempo
     fornisce funzionalità maggiori.
    </para>
    <para>
     Per ulteriori dettagli vedere anche
     <function>mssql_fetch_row</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-field">
   <refnamediv>
    <refname>mssql_fetch_field</refname>
    <refpurpose>Restituisce le informazioni di un campo</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>object <function>mssql_fetch_field</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>offset_campo</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     La funzione restituisce un oggetto contenente le informazioni sul campo.  
    </para>
    <para>
     La funzione <function>mssql_fetch_field</function> può essere utilizzata
     per ottenere informazioni sui campi presenti nel risultato di una certa query.
     Se non viene specificato l'argomento offset_campo, la funzione restituisce
     il campo successivo che non è ancora stato restituito da 
     <function>mssql_fetch_field</function>.
    </para>
    <para>
     Le proprietà dell'oggetto sono:
    </para>
    <itemizedlist>
     <listitem>
      <simpara>
       name - nome della colonna. Se la colonna è il risultato di una funzione, questa
       proprietà è valorizzata con "computed#N", dove #N è un numero progressivo.
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       column_source - tabella da cui sono ricavate le colonne
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       max_length - lunghezza massima della colonna
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       numeric - 1 se la colonna è numerica
      </simpara></listitem> 
    </itemizedlist>
    <para>
     Vedere anche <function>mssql_field_seek</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-object">
   <refnamediv>
    <refname>mssql_fetch_object</refname>
    <refpurpose>Restituisce una riga come oggetto</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_fetch_object</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     La funzione restituisce un oggetto le cui proprietà corrispondono alla riga estratta,
     oppure falso se non vi sono più righe.
    </para>
    <para> 
     La funzione <function>mssql_fetch_object</function> è simile a
     <function>mssql_fetch_array</function>, tranne che per una
     differenza, la prima restituisce un oggetto, la seconda un array.
     Indirettamente questo significa che si può accedere ai dati solo 
     attraverso il nome dei campi e non tramite il loro offset ( i numeri non
     sono dei validi nomi di proprietà ).
    </para>
    <para>
      A livello di velocità il comportamento è simile a
     <function>mssql_fetch_array</function>, e quasi veloce come 
     <function>mssql_fetch_row</function> (la differenza è 
     insignificante ).
    </para>
    <para> 
     Vedere anche <function>mssql_fetch-array</function> and
     <function>mssql_fetch-row</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-row">
   <refnamediv>
    <refname>mssql_fetch_row</refname>
    <refpurpose>Restituisce una riga come array numerato</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>array <function>mssql_fetch_row</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     La funzione restituisce un array che corrisponde alla riga estratta, 
     oppure falso se non vi sono più righe.
    </para>
    <para>
     La funzione <function>mssql_fetch_row</function> estrae una riga
     di dati dal risultato associato all'identificativo di risultato passato. 
     La riga viene restituita in un array. Ciascuna colonna è memorizzata 
     in un campo dell'array. Il primo ha indice 0.
    </para>
    <para>
     Esecuzione successive di <function>mssql_fetch_rows</function> restituiscono
     le righe successive presenti nel risultato, oppure falso
     se non vi sono più righe.
    </para>
    <para>
     Vedere anche <function>mssql_fetch_array</function>,
     <function>mssql_fetch_object</function>,
     <function>mssql_data_seek</function>,
     <function>mssql_fetch_lengths</function>, e
     <function>mssql_result</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-field-length">
   <refnamediv>
    <refname>mssql_field_length</refname>
    <refpurpose>Restituisce la lunghezza di un campo</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_field_length</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>offset</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-field-name">
   <refnamediv>
    <refname>mssql_field_name</refname>
    <refpurpose>Restituisce il nome di un campo</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_field_name</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>offset</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-field-seek">
   <refnamediv>
    <refname>mssql_field_seek</refname>
    <refpurpose>Posizionamento sul campo</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_field_seek</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
      <paramdef>int <parameter>offset_campo</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     Si posiziona sul campo richiesto. Eseguendo successivamente la 
     funzione <function>mssql_fetch_field</function> senza indicare alcun campo,
     quest'ultima restituirà il campo richiesto tramite 
     <function>mssql_fetch_field</function>.</para>
    <para></para>
    <para>
     Vedere anche <function>mssql_fetch_field</function>.</para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-field-type">
   <refnamediv>
    <refname>mssql_field_type</refname>
    <refpurpose>Restituisce il tipo di un campo</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string <function>mssql_field_type</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>offset</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-free-result">
   <refnamediv>
    <refname>mssql_free_result</refname>
    <refpurpose>Libera la memoria di un risultato</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_free_result</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     La funzione <function>mssql_free_result</function> permette
     di non utilizzare molta memoria durante l'esecuzione di uno script. 
     Infatti, se si è sicuri di non avere più bisogno dei dati del risultato, 
     si può eseguire <function>mssql_free_result</function>, e la memoria associata
     a <parameter>id_risultato</parameter> sarà liberata. Se la funzione
     non viene utilizzata, le aree di memoria resteranno disponibili per tutta
     la durata dello script. Al termine verranno liberate in modo automatico.
     Tuttavia utilizzando la funzione <function>mssql_free_result</function>, 
     l'area di memoria del risultato associato a id_risultato, sarà liberata.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-get-last-message">
   <refnamediv>
    <refname>mssql_get_last_message</refname>
    <refpurpose>
     Restituisce l'ultimo messaggio dal server ( oltre min_message_severity?)
    </refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>string 
       <function>mssql_get_last_message</function>
      </funcdef>
      <paramdef>void <parameter></parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-min-error-severity">
   <refnamediv>
    <refname>mssql_min_error_severity</refname>
    <refpurpose>Setta il livello minimo di errori critici.</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void 
       <function>mssql_min_error_severity</function>
      </funcdef>
      <paramdef>int <parameter>livello_critico</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-min-message-severity">
   <refnamediv>
    <refname>mssql_min_message_severity</refname>
    <refpurpose>Setta li livello critico minimo di messaggi</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>void 
       <function>mssql_min_message_severity</function>
      </funcdef>
      <paramdef>int <parameter>livello_critico</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-num-fields">
   <refnamediv>
    <refname>mssql_num_fields</refname>
    <refpurpose>Restituisce il numero di campi in un risultato</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_num_fields</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     La funzione <function>mssql_num_fields</function> restituisce il numero di
     campi presenti in un risultato.
    </para>
    <para> 
     Vedere anche: <function>mssql_db_query</function>,
     <function>mssql_query</function>,
     <function>mssql_fetch_field</function>, e
     <function>mssql_num_rows</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-num-rows">
   <refnamediv>
    <refname>mssql_num_rows</refname>
    <refpurpose>Restituisce il numero di righe</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_num_rows</function></funcdef>
      <paramdef>string <parameter>id_risultato</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     La funzione <function>mssql_num_rows</function> restituisce il numero di righe
     presenti in un risultato.
    </para>
    <para>
     Vedere anche: <function>mssql_db_query</function>,
     <function>mssql_query</function>, e
     <function>mssql_fetch_row</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-pconnect">
   <refnamediv>
    <refname>mssql_pconnect</refname>
    <refpurpose>Apre una connessione persistente con MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_pconnect</function></funcdef>
      <paramdef>string 
       <parameter><optional>nome_server</optional></parameter>
      </paramdef>
      <paramdef>string 
       <parameter><optional>nome_utente</optional></parameter>
      </paramdef>
      <paramdef>string 
       <parameter><optional>password</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     La funzione restituisce: o un identificativo di connessione persistente, 
     o falso se si verifica un errore.
    </para>
    <para>
     La funzione <function>mssql_pconnect</function> agisce come 
     <function>mssql_connect</function> tranne che per due differenze.
    </para>
    <para> 
     Prima differenza, quando si cerca di stabilire la connessione, la funzione
     per prima cosa cerca di trovare una connessione ( persistente ) già
     aperta verso lo stesso server con i medesimi utenti e password.
     Se ne viene trovata una, la funzione restituisce l'identificativo di 
     quella connessione, invece di stabilirne una nuova.
    </para>
    <para> 
     Seconda differenza, la connessione con il server SQL non verrà chiusa
     al termine dello script. Il collegamento resterà aperto per utilizzi futuri
     (la funzione <function>mssql_close</function> non chiude i collegamenti
      aperti da <function>mssql_pconnect</function>).
    </para>
    <para> 
     Per questo motivo questo tipo di collegamento viene definito 'persistente'.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-query">
   <refnamediv>
    <refname>mssql_query</refname>
    <refpurpose>Invia una query a MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_query</function></funcdef>
      <paramdef>string <parameter>teso_query</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>id_connessione</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     La funzione restituisce un identificativo di risultato in caso di esecuzione 
     corretta, oppure falso in caso di errore.
    </para>
    <para> 
     La funzione <function>mssql_query</function> invia una query al database
     attivo sul server attraverso la connessione specificata da id_connessione.
     Se l'argomento id_connessione non viene fornito, si utilizza l'ultima connessione
     aperta in ordine di tempo. Se non vi sono connessioni aperte, 
     la funzione tenta di stabilire una connessione, come se fosse 
     utilizzata la funzione <function>mssql_connect</function>, e utilizza
     quella.
    </para>
    <para>
     Vedere anche: <function>mssql_db_query</function>,
     <function>mssql_select_db</function>, e
     <function>mssql_connect</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-result">
   <refnamediv>
    <refname>mssql_result</refname>
    <refpurpose>Restituisce i dati di un risultato</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_result</function></funcdef>
      <paramdef>int <parameter>id_risultato</parameter></paramdef>
      <paramdef>int <parameter>i</parameter></paramdef>
      <paramdef>mixed <parameter>campo</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     La funzione restituisce il contenuto della cella ( identificata dalla riga
     e dal campo indicato) dal risultato associato a id_risultato.
    </para>
    <para>
     La funzione <function>mssql_result</function> restituisce il contenuto di una
     cella da un risultato di una query a MS SQL. 
     L'argomento campo può essere la posizione di un campo, oppure il suo nome, 
     oppure nome tabella punto nome campo ( nome_tabella.nome_campo ).  Se il nome
     della colonna ha un sostituto, ('select foo as bar from...'), usare quello
     anzichè il nome originale.
    </para>
    <para>
     Quando si lavora con risultati abbastanza grossi, si dovrebbe considerare
     l'utilizzo di funzioni che restituiscono l'intera riga ( indicate di seguito ),
     dato che queste restituiscono il contenuto di molte celle in una chiamata sola.
     Pertanto sono MOLTO più veloci di <function>mssql_result</function>.
     Da notare inoltre, che specificando la posizione per l'argomento campo, la funzione
     è molto più veloce rispetto al caso in cui si indica il nome del campo o della tabella.   
    </para>
    <para>
     Le alternative più veloci raccomandate sono:
     <function>mssql_fetch_row</function>,
     <function>mssql_fetch_array</function>, e
     <function>mssql_fetch_object</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-select-db">
   <refnamediv>
    <refname>mssql_select_db</refname>
    <refpurpose>Seleziona un database MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descrizione</title>
    <funcsynopsis>
     <funcprototype>
      <funcdef>int <function>mssql_select_db</function></funcdef>
      <paramdef>string <parameter>Nome_database</parameter></paramdef>
      <paramdef>int 
       <parameter><optional>id_connessione</optional></parameter>
      </paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Restituisce: vero se l'operazione riesce, falso se si verifica un errore.
    </para>
    <para> 
     La funzione <function>mssql_select_db</function> setta il database attivo
     sul server attraverso la connessione specificata da id_connessione.
     Se l'argomento id_connessione non viene fornito, si utilizza l'ultima connessione
     aperta in ordine di tempo. Se non vi sono connessioni aperte, 
     la funzione tenta di stabilire una connessione, come se fosse 
     utilizzata la funzione <function>mssql_connect</function>, e utilizza
     quella.
    </para>
    <para>
     Ciascuna esecuzione di <function>mssql_query</function> sarà
     fatta sul database attivo.
    </para>
    <para> Vedere anche:
     <function>mssql_connect</function>, 
     <function>mssql_pconnect</function>, e
     <function>mssql_query</function>
    </para>
   </refsect1>
  </refentry>

</reference>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
